\ProvidesPackage{unito}[Beamer theme for UniTO theses presentations]

% ================================================================================
% Packages
% ================================================================================

\RequirePackage{tikz}
\RequirePackage{xcolor}
\RequirePackage{amsmath}
\RequirePackage{amsfonts}
\RequirePackage{verbatim}
\RequirePackage{hyperref}
\RequirePackage{listings}
\RequirePackage{enumerate}
\RequirePackage[utf8]{inputenc} % utf8 encoding in the input (.tex) file
\RequirePackage[T1]{fontenc} % utf8 encoding in the output (.pdf) file

\RequirePackage{amssymb} % Math symbols, including \blacktriangleright, used for bullets
\RequirePackage[scaled=.97,helvratio=.93,p,theoremfont]{newpxtext} % Serif palatino font
\RequirePackage[vvarbb,smallerops,bigdelims]{newpxmath} % Math palatino font
\RequirePackage[scaled=.85]{beramono} % Monospace font
\RequirePackage[scr=rsfso,cal=boondoxo]{mathalfa} % Mathcal from STIX, unslanted a bit





% ================================================================================
% Color Accents
% ================================================================================

\definecolor{primarycolor}{HTML}{D61524}
\definecolor{customgrey}{HTML}{54565A}
\definecolor{skyblue}{HTML}{6BA4B8}

\setbeamercolor{title}{fg=black}
\setbeamercolor{author}{fg=black}
\setbeamercolor{date}{fg=black}
\setbeamercolor{head}{bg=black}

\setbeamercolor{alerted text}{fg=primarycolor}
\setbeamercolor{normal text}{fg=darkgray,bg=white}
\setbeamercolor{structure}{fg=customgrey}

\setbeamercolor{jumbo}{bg=primarycolor}
\setbeamercolor{progress bar}{fg=primarycolor,bg=customgrey}
\setbeamercolor{progress bar progress}{use=progress bar,bg=progress bar.fg}

\hypersetup{
	colorlinks,
	linkcolor=primarycolor,
	anchorcolor=red,
	citecolor=blue!80,
	urlcolor=skyblue,
}

%\setbeamercolor{block title}{fg=airforceblue,bg=morelightgray}
%\setbeamercolor{block body}{fg=darkgray,bg=morelightgray}

% ================================================================================
% Fonts
% ================================================================================
% Define supervisor for maketitle
\def\supervisor#1{\gdef\@supervisor{#1}}
\def\cosupervisor#1{\gdef\@cosupervisor{#1}}

\setbeamerfont{author}{size=\small}
\setbeamerfont{date}{size=\footnotesize}
\setbeamerfont{title}{series=\bfseries, size=\Large}
\setbeamerfont{subtitle}{series=\mdseries,size=\normalsize}

\setbeamerfont{frametitle}{series=\bfseries}
\setbeamerfont{framesubtitle}{series=\mdseries}
\setbeamerfont{footline}{size=\scriptsize}
\setbeamerfont{block title}{series=\centering, size=\small}
\setbeamerfont{block body}{size=\scriptsize}

\usefonttheme{serif}

% ================================================================================
% Basic Settings
% ================================================================================

% cancel navigation symbols
\setbeamertemplate{navigation symbols}{}

% prettier boxes
\setbeamertemplate{blocks}[rounded]

% bullet points
\setbeamertemplate{itemize item}{\small$\blacktriangleright$}
\setbeamertemplate{itemize subitem}{\textemdash}
\setbeamertemplate{itemize subsubitem}{\ensuremath{\circ}}

% paragraph spacing
\setlength{\parskip}{10pt}



% code environment
\lstdefinestyle{mystyle}{
    commentstyle=\color{skyblue},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{customgrey},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\scriptsize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=4,
    xleftmargin=10pt,
    xrightmargin=10pt,
}
\lstset{style=mystyle}

% ================================================================================
% Slide Templates
% ================================================================================

% headline for all frames
\setbeamertemplate{headline}{
	\ifnum\theframenumber=1
		% not display the headline for the title page
	\else
        \vspace{10pt}
        \hspace{370pt}\includegraphics[width=60pt]{source/logo_new_2022.png}
	\fi
    \vspace{0pt}
}

% frame title and subtitle
\setbeamertemplate{frametitle}{
    \begin{picture}(0,18)
        \ifx\insertframesubtitle\@empty%
            \put(0,25){\usebeamerfont{frametitle}\usebeamercolor[black]{}\insertframetitle}%
		\else%
			\put(0,32){\usebeamerfont{frametitle}\usebeamercolor[black]{}%
            \insertframetitle}%
			\put(2,19){\usebeamerfont{framesubtitle}\usebeamercolor[black]{}
            \insertframesubtitle }
		\fi
    \end{picture}
    \vspace{0pt}
}

% title page
\setbeamertemplate{title page}{
	\begin{picture}(0,0)
		\put(0,60){\includegraphics[width=70pt]{source/logo_new_2022.png}}
        \put(273,-248){\includegraphics[height=\paperheight]{source/logo_new_only_logo-5.pdf}}
		\put(0,0){%
			\begin{minipage}{400pt}
				\vspace{10pt}
				\usebeamerfont{title}\usebeamercolor[fg]{title}\inserttitle\par
			\end{minipage}
		}
		\put(0,-85){%
          \begin{minipage}{400pt}
			\usebeamerfont{author}\usebeamercolor[fg]{author}\textbf{Candidate}: \insertauthor\par
			\vspace{5pt}
			\usebeamerfont{author}\usebeamercolor[fg]{author}\textbf{Supervisor}: \@supervisor\par
			\vspace{5pt}
			\usebeamerfont{author}\usebeamercolor[fg]{author}\textbf{Co-Supervisor}: \@cosupervisor\par
          \end{minipage}
		}
		
	\end{picture}
}


\defbeamertemplate{footline}{progress bar}{
	\dimen0=\paperwidth
	\multiply\dimen0 by \insertframenumber
	\divide\dimen0 by \inserttotalframenumber
	\edef\progressbarwidth{\the\dimen0}
	\leavevmode%
	\ifnum\theframenumber=1
	\else
        \begin{picture}(0,0)
            \put(-2,0){
		      \begin{beamercolorbox}[wd=\paperwidth,ht=6pt,dp=1pt]{progress bar}
    			\begin{beamercolorbox}[wd=\progressbarwidth,ht=6pt,dp=1pt]{progress bar progress}
    			\end{beamercolorbox}%
            \end{beamercolorbox}
            }
	          \ifnum\theframenumber=\inserttotalframenumber
                % exclude last slide numbering
            \else
                \put(10, 10){\insertframenumber}
            \fi
        \end{picture}
	\fi
}

\setbeamertemplate{footline}[progress bar]

% last frame
% \newcommand{\backmatter}{
% 	\begingroup
% 	\setbeamertemplate{headline}{}
% 	\setbeamertemplate{footline}{}
% 	\begin{frame}[c]{}
% 	\end{frame}
% \endgroup
% }

% style of sections and subsections in ToCs
\setbeamertemplate{section in toc}{
	$\blacktriangleright$~\inserttocsection
}
\setbeamertemplate{subsection in toc}{}
\setbeamertemplate{frametitle continuation}{}

\setbeamertemplate{footnote}{ % <---
  \makebox[1em][l]{\insertfootnotemark}%
  \begin{minipage}{\dimexpr\linewidth-1em}
    \footnotesize\linespread{0.84}\selectfont\insertfootnotetext
  \end{minipage}\vskip 0pt 
}% end of footnote template

% begin of sections
% \AtBeginSection[]
% {
%     \begingroup
%     \begin{frame}{Contents}{}
%     	\begin{picture}(0,0)
%     		\put(-28.5,-166){\includegraphics[width=\paperwidth]{source/silhouette}}
%     	\end{picture}
%         \tableofcontents[currentsection]
%     \end{frame}
%     \endgroup
% }