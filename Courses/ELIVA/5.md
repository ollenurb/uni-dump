# La trasformata di Fourier

## Introduzione
L'idea alla base dello studio dei segnali periodici di Fourier è che ogni
funzione **periodica** può essere scritta come la **somma** di *seni* e
*coseni*, di differenti *ampiezze* e *frequenze* (in caso solo un tipo di
funzione venga utilizzato - seno o coseno - allora si utilizza anche la *fase*).
Questa somma viene chiama **serie di Fourier**. 

Nel caso invece delle funzioni **non-periodiche**, si possono rappresentare come
un *integrale* di *seni* e *coseni* pesati (da un'opportuna funzione). Questa
rappresentazione viene invece chiamata **trasformata di Fourier**.

> *La rappresentazione nel **dominio di Fourier** è *equivalente*
> all'originale.*

## La serie di Fourier
Come già citato in precedenza, ogni funzione periodica di periodo $T$ (o
equivalentemente di frequenza $\omega = \frac{2 \pi}{T}$) può essere espresso
come
$$
f(t) = \sum^{\infty}_{n = -\infty} c_n e^{j\omega n t} \quad \text{ con } n\in
\mathbb{Z}
$$
dove i coefficienti calcolati con la seguente formula
$$
c_n = \frac{1}{T} \int^{T/2}_{-T/2} f(t) e^{-j \omega nt} dt
$$
i coefficienti vanno ad indicare *quanto* la frequenza fondamentale $\omega n$ è
presente all'interno del segnale $f(t)$. In altri termini, questo integrale va a
calcolare la similarità tra il segnale *"sonda"* $f(t)$ e la frequenza
fondamentale $e^{j\omega nt}$.

> **Formula di Eulero**: $e^{j \omega} = cos(\omega) + j sin(\omega)$

Si noti che $T$ indica la *risoluzione* della pulsazione in frequenza. Tanto più
$T$ è grande, tanto più sarà grande.

## La trasformata di Fourier
Per fare da *"ponte"* tra la serie e la trasformata di Fourier, è necessario
introdurre un concetto fondamentale: la distribuzione *delta di Dirac*. Tale
funzione (più correttamente *distribuzione*) è caratterizzata da un impulso di
ampiezza infinita e di una durata infinitamente piccola (puntuale), ed è
definita matematicamente nel modo seguente
$$
\delta(t) = 
\begin{cases}
\infty & \text{if } t=0\\
0 & \text{otherwise}
\end{cases}
$$
inoltre, essendo una distribuzione deve valere che
$$
\int_{-\infty}^{\infty} \delta(t) dt = 1
$$
ha una proprietà molto importante detta *shifting property* (oppure *sampling
property*) tale per cui, presa una funzione $f(t)$ e moltiplicata per la *delta
di Dirac*, ne ritorna il valore al punto $0$ (in generale, nel punto in cui è
centrata la funzione $\delta$). Tale proprietà generale è riassumibile nel modo
seguente
$$
\int_{-\infty}^{\infty} f(t) \delta(t - u) dt = f(t - u)
$$
L'intuizione è che siccome la distribuzione $\delta$ è 0 ovunque tranne che
intorno ai valori $t-u$, l'integrale anche è nullo per cui si possono
considerare solo gli estremi di integrazione in un intorno infinitesimamente
piccolo di $t-u$. In questo intorno la funzione $f(t - u)$ non cambia, per cui è
costante e può esser portata fuori dall'integrale. A questo punto, l'integrale
della distribuzione $\delta$ è 1, per cui ne deriva la dimostrazione.

È importante notare che questa proprietà vale anche nel discreto, creando di
fatto una connessione tra la trasformata e la serie che verrà discussa più
avanti.

Avendo introdotto tutto il necessario, per ottenere la trasformata dalla serie
facciamo tendere (nella definizione di serie di Fourier) $T \rightarrow \infty$.
Focalizzandosi inizialmente solo sul calcolo dei coefficienti $c_n$, notiamo in
primo luogo (dalla definizione data precedentemente), che l'estremo di
integrazione diventa da $-\infty$ a $+\infty$. Inoltre, la variabile discreta
$n$, siccome è divisa per $T$, indica delle frequenze arbitrariamente vicine,
per cui $\frac{n}{T}$ viene sostituito da una variabile continua $u$. Infine, il
termine moltiplicativo $\frac{1}{T}$ diventa per definizione il *differenziale*
dell'integrale $dt$. Otteniamo quindi la cosiddetta **trasformata** di Fourier,
riportata in seguito
$$
F(u) = \int^{-\infty}_{+\infty} f(t) e^{-j 2\pi ut} dt
$$
Si noti che la funzione $F(u)$ è in funzione della *frequenza*, ed equivale alla
rappresentazione di $f$ nel dominio delle *frequenze*. È possibile anche
definire la trasformata inversa, semplicemente applicando lo stesso processo al
limite alla definizione della *serie*, e sostituendo le definizioni dei
coefficienti con la definizione di trasformata
$$
f(t) = \int^{-\infty}_{+\infty} F(u) e^{j 2\pi ut} du
$$
tra la trasformata e l'inversa cambia solo il segno dell'esponenziale, per cui
si dice che la trasformata rispetta la proprietà di **simmetria**.

Un'altra proprietà importante della trasformata di Fourier è che nonostante
individui tutte le frequenze presenti in un segnale, le informazioni di tipo
*spaziale* (o *temporale* nel caso di segnali nel tempo) vengono perse. Questo è
dimostrabile considerando la trasformata di un segnale qualunque traslato poiché
il risultato (in modulo) non cambia rispetto al segnale non traslato (dettagli
matematici sule slides).

### Trasformate importanti

#### Funzione Rettangolo
Una delle poche funzioni di cui è necessaria una certa dimestichezza con la sua
trasformata è la funzione $sinc$. Per introdurla, prendiamo un segnale a
finestra (potrebbe, per esempio, essere una riga di pixel) definita nel modo
seguente
$$
f(t) = 
\begin{cases}
A &\text{for } -a \leq t \leq a\\
0 &\text{otherwise}
\end{cases}
$$
La trasformata $F$ di tale funzione è la cosiddetta *funzione sinc*:
$$
F(u) =
\int_{-a}^{+a} A e^{-j 2\pi u t} dt =
\left [ \frac{A}{-2j\pi u} e^{-2\pi u t} \right ]_{-a}^{a} =
\frac{sin(2a\pi u)}{2a\pi u} = 
a \cdot A \cdot sinc(2a u)
$$

> *Graficamente, la funzione $sinc$ ha valore $1$ in $u=0$, e oscilla con $u
  \rightarrow \infty$ avvicinandoci asintoticamente all'asse $x$.*

Ovviamente, possiamo anche definire la trasformata per segnali bi-dimensionali,
per cui la trasformata di un segnale rettangolare bi-dimensionale (ad esempio
una porzione d'immagine) in questo caso sarebbe una funzione $sinc$
bi-dimensionale.

#### Delta di Dirac
Vale la pena considerare anche la trasformata della funzione $\delta$ introdotta
precedentemente, poichè ha diverse caratteristiche degne di nota.
$$
F(u) = \int^{-\infty}_{+\infty} \delta(t) e^{-j 2\pi ut} dt = e^{-j 2 \pi u 0} =
1
$$
il fatto che la trasformata sia la funzione costante $1$, indica che tutte le
frequenze sono contenute all'interno di un implulso. In generale, vale che
$$
F(u) = \int^{-\infty}_{+\infty} \delta(t - t_0) e^{-j 2\pi ut} dt = e^{-j 2 \pi u t_0}
$$
ciò significa che la trasformata della funzione delta di Dirac individua la
frequenza fondamentale multipla di $t_0$.

Inoltre, grazie alla relazione della trasformata inversa otteniamo che
$$
\delta(t) = \int^{-\infty}_{+\infty} e^{j2 \pi u t} du
$$

#### Segnale Monocromatico
Consideriamo il segnale monocromatico $f(t) = A cos(2 \pi u_0 t)$ e calcoliamone
la trasformata
$$
F(u) = \int^{-\infty}_{+\infty} A\; cos(2 \pi u_0 t) e^{-j2 \pi u t} dt =
A \left ( \delta(u - u_0) + \delta(u + u_0) \right )
$$
ciò significa che la trasformata sarà composta da due $delta$ di Dirac centrate
nei punti $u_0$ e $-u_0$. Questo è ragionevole poichè la trasformata è sempre
simmetrica rispetto all'asse $y$, per cui la funzione $delta$ individua la
frequenza $u_0$, che è effettivamente l'unica frequenza contenuta nella funzione
originale.

## Teorema del campionamento
Per campionare un segnale possiamo utilizzare la proprietà vista in precedenza
della funzione $\delta$ di Dirac. L'idea è quella di definire una serie di
funzioni $\delta$ equispaziate di un certo $\Delta T$ (chiamato *periodo di
campionamento*). Si costruisce quindi il seguente *treno di impulsi*
$$
s(t) = \sum^{+\infty}_{n = -\infty} \delta(t - n \Delta T)
$$
la cui trasformata sarà
$$
S(u) = \frac{1}{\Delta T} \sum^{+\infty}_{n = -\infty} \delta(u -
\frac{n}{\Delta T})
$$
La trasformata è ancora un *treno di impulsi*, equispaziati di $\frac{n}{\Delta
T}$. Si noti che tanto più gli impulsi sono vicini nella funzione iniziale
(quindi valori $\Delta T$ piccoli che corrispondono ad una frequenza di
campionamento alta), tanto più gli impulsi nella trasformata saranno distanti.

Intruitivamente, quindi, se cerchiamo di avvicinare le varie delta tra loro nel
dominio spaziale (o temporale), le distanziamo nel dominio delle frequenze.
Questo è ragionevole perché la trasformata andrà a coprire frequenze più alte.

## Teorema della Convoluzione
Precedentemente abbiamo trattato la convoluzione come operazione di media mobile
nel discreto, ma è possibile definirla anche nel continuo. La convoluzione di
due funzioni $h$ e $f$ è così definita
$$
f(t) \star h(t) = \int^{\infty}_{-\infty} f(\tau) h(t - \tau) d\tau
$$

\begin{theorem}[Di Convoluzione]
La convoluzione di due funzioni $h$ e $f$ è pari al prodotto delle loro
rispettive trasformate $H$ e $F$, formalmente
$$
f(t) \star h(t) = F(u) \cdot H(u)
$$
\end{theorem}

La dimostrazione del teorema è banale, poichè basta applicare la definizione di
trasformata all'operazione di convoluzione. Calcoliamo innanzitutto la
trasformata di $h(t - \tau)$ per semplificare i calcoli successivamente
$$
\begin{split}
\mathscr{F}[h(t - \tau)]
& = \int h(t - \tau) e^{-j2 \pi u t} dt\\
& = \int h(v) e^{-j2 \pi u (v + \tau)} dv \;(v = t - \tau)\\
& = e^{-j2 \pi u \tau} \int h(v) e^{-j2 \pi v} dv\\
& = H(u) \cdot e^{-j2 \pi u \tau}
\end{split}
$$
passiamo ora a calcolare la trasformata della convoluzione, ottenendo quindi la
dimostrazione. Il passaggio principale consiste nel cambiare l'ordine degli
integrali (per linearità), sostituendo successivamente le varie definizioni che
compaiono
$$
\begin{split}
\mathscr{F}[f \star h]
& = \int \left ( \int f(\tau) h(t - \tau) d\tau \right ) e^{-j 2\pi u t} dt \\
& = \int f(\tau) \left ( \int h(t - \tau)  e^{-j 2\pi u t} dt\right ) d\tau \\
& = \int f(\tau) H(u) e^{-j 2\pi u \tau} d\tau \\
& = H(u) \int f(\tau) e^{-j 2\pi u \tau} d\tau \\
& = F(u) \cdot H(u) \quad \blacksquare
\end{split}
$$
da questo teorema risulta evidente il perché $h$ venga anche chiamato *filtro*.
Vale quindi che tutte le operazioni che abbiamo definito nel dominio dello
spazio per mezzo di un'operazione di convoluzione, possono essere fatte
semplicemente per mezzo di una moltiplicazione nel dominio delle frequenze.

